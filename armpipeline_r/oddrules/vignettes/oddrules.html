<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Carol" />

<meta name="date" content="2016-04-11" />

<title>Odds Ratios for Rules</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%7D%0Apre%20%7B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div class="fluid-row" id="header">


<h1 class="title">Odds Ratios for Rules</h1>
<h4 class="author"><em>Carol</em></h4>
<h4 class="date"><em>2016-04-11</em></h4>

</div>


<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(oddrules)</code></pre>
<div id="odds-ratios-for-rules" class="section level1">
<h1>Odds Ratios for Rules</h1>
<p>This package works with arules to mine and test rules in a data set. This document will provide an example of this process using pollution data included in the package.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(Pollution)</code></pre>
<div id="using-bin_quantile" class="section level2">
<h2>Using bin_quantile</h2>
<p>This data includes an event column referring to asthma attacks, and 31 columns of pollution data for different pollutants with different lags. The values for pollution concentration are continous, so the first thing we need to do is put it into a logical format that can be coerced into transactions and mined for rules. We do this using the function bin_quantile.</p>
<pre class="sourceCode r"><code class="sourceCode r">binned =<span class="st"> </span><span class="kw">bin_quantile</span>(Pollution, <span class="dt">col=</span><span class="dv">2</span>:<span class="dv">31</span>, <span class="dt">top=</span><span class="fl">0.95</span>)</code></pre>
<p>Where pollution refers to the data set were using, col refers to the columns to be binned, and top refers to the probabilty of the quantile, in this case at 0.95 the bottom 95 percent will be tagged FALSE and the top 5 percent will be tagged TRUE. The output should be a list of both the labeled dataset and the thresholds used.</p>
<p>Called in this way, bin_quantile will establish a threshold for each column and bin them based on that threshold either TRUE or FALSE. However in some cases we may not want to establish a new threshold for each column, or we may want to use several columns to establish a threshold. For example in our data set, we have five columns for each type of pollutant at different lags. We may want to bin these together and we can using the parameter group.</p>
<pre class="sourceCode r"><code class="sourceCode r">binned2 =<span class="st"> </span><span class="kw">bin_quantile</span>(Pollution, <span class="dt">col=</span><span class="dv">2</span>:<span class="dv">31</span>, <span class="dt">top=</span><span class="fl">0.95</span>, <span class="dt">group=</span><span class="dv">5</span>)</code></pre>
<p>Now we have created a data set where each 5 columns have been processed and binned together. All the data in the group has gone into making the threshold and the same threshold has been used for all five columns.</p>
<p>In some cases we may want to only use one column per group to establish the group threshold. For instance in our data set the first column of each group has the shortest lag time so we may want to bin all five columns by the threshold of the first column. We can do this using the parameter groupthreshold.</p>
<pre class="sourceCode r"><code class="sourceCode r">binned3 =<span class="st"> </span><span class="kw">bin_quantile</span>(Pollution, <span class="dt">col=</span><span class="dv">2</span>:<span class="dv">31</span>, <span class="dt">top=</span><span class="fl">0.95</span>, <span class="dt">group=</span><span class="dv">5</span>, <span class="dt">groupthreshold=</span><span class="dv">1</span>)</code></pre>
</div>
<div id="mining-rules" class="section level2">
<h2>Mining Rules</h2>
<p>Since we only want the data set we can use a couple commands to get it off the list and back in logical format.</p>
<pre class="sourceCode r"><code class="sourceCode r">binned &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(binned$data)
sample &lt;-<span class="st"> </span>binned
sampleLog &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">lapply</span>(sample, as.logical))</code></pre>
<p>Then we will want to split the data into training and testing using random_split.</p>
<pre class="sourceCode r"><code class="sourceCode r">splitdata &lt;-<span class="st"> </span><span class="kw">random_split</span>(sampleLog, <span class="dt">seed=</span><span class="dv">1</span>, <span class="dt">split=</span><span class="dv">5000</span>) 
whole_training &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(splitdata$whole_training)
testing &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(splitdata$testing)</code></pre>
<p>The function random_split splits the data set using a seed specified by the user with a default of one. The parameter split determines the size of the training set and the rest of the data goes into testing. The output is a list with the training and testing dataframes.</p>
<p>After this we can coerce the training and testing set into transactions and mine the rules using the apriori function from the package arules. In this case we will also subset rules leading to the event.</p>
<pre class="sourceCode r"><code class="sourceCode r">trainingTrans &lt;-<span class="st"> </span><span class="kw">as</span>(whole_training, <span class="st">&quot;transactions&quot;</span>)
rules &lt;-<span class="st"> </span><span class="kw">apriori</span>(trainingTrans, <span class="dt">parameter =</span> <span class="kw">list</span>(<span class="dt">support =</span> <span class="fl">0.005</span>, <span class="dt">confidence =</span> <span class="fl">0.0</span>, <span class="dt">maxlen =</span> <span class="dv">6</span>))</code></pre>
<pre><code>## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 5000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.01s].
## checking subsets of size 1 2 3 done [0.00s].
## writing ... [269 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">rules &lt;-<span class="st"> </span><span class="kw">subset</span>(rules, <span class="dt">subset =</span> rhs %in%<span class="st"> &quot;event&quot;</span>)</code></pre>
</div>
<div id="abstracting-useful-information-about-the-rules" class="section level2">
<h2>Abstracting Useful information about the rules</h2>
<p>The package oddrules offers a few specialized functions for abstracting useful information about the rules.Some of these functions require a secondary input with negated features like below.</p>
<pre class="sourceCode r"><code class="sourceCode r">sampleNot &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(!whole_training)
sampleNot$event &lt;-<span class="st"> </span>whole_training$event
trainingNot &lt;-<span class="st"> </span><span class="kw">as</span>(sampleNot, <span class="st">&quot;transactions&quot;</span>)</code></pre>
<p>The first function myOddsRatio is based on a function included in the package arules (.basicRuleMeasure) originally designed to compute various measures of interest for association rules. It has been modified to make it dedicated to odds ratio only, with some new functionalities (standard error, confidence interval, statistical significance). It can be called as follows.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">myOddsRatioExp</span>(rules, trainingTrans, trainingNot, <span class="dt">CI=</span><span class="ot">TRUE</span>, <span class="dt">t=</span><span class="fl">0.03</span>)</code></pre>
<pre><code>##    oddsRatio standardError   lowCI95 highCI95 significance chi_squared
## 1  1.0000000      1.052026 0.9053749 1.104515        FALSE  0.00000000
## 2  1.3319282      1.205867 0.9228562 1.922328        FALSE  2.35937387
## 3  1.0999255      1.216590 0.7489974 1.615274        FALSE  0.23617038
## 4  1.1157507      1.213610 0.7634345 1.630657        FALSE  0.32036341
## 5  1.3314054      1.241161 0.8717803 2.033357        FALSE  1.76667739
## 6  0.9223094      1.227493 0.6171619 1.378333        FALSE  0.15575710
## 7  0.7372849      1.236141 0.4866109 1.117092        FALSE  2.08211008
## 8  1.5628219      1.197231 1.0981985 2.224017         TRUE  6.24727078
## 9  1.3828170      1.226050 0.9274466 2.061771        FALSE  2.55034610
## 10 0.8769262      1.215250 0.5984369 1.285014        FALSE  0.45444617
## 11 1.0862217      1.201189 0.7583689 1.555810        FALSE  0.20366554
## 12 1.2402465      1.209883 0.8537511 1.801709        FALSE  1.28173564
## 13 1.1493506      1.202398 0.8008625 1.649480        FALSE  0.57118531
## 14 0.8274939      1.221400 0.5591439 1.224633        FALSE  0.89891204
## 15 1.0349781      1.208813 0.7136864 1.500911        FALSE  0.03287027
## 16 1.3167553      1.240825 0.8626450 2.009917        FALSE  1.63602828
## 17 1.2381263      1.179311 0.8961355 1.710631        FALSE  1.68307840
## 18 1.8077296      1.196746 1.2713035 2.570501         TRUE 11.16305816
## 19 1.4053851      1.194511 0.9919796 1.991076         TRUE  3.69882877
## 20 1.4017995      1.207183 0.9691934 2.027502        FALSE  3.24636634
## 21 1.2370922      1.219454 0.8385282 1.825099        FALSE  1.15407432
## 22 1.4832689      1.217776 1.0081091 2.182390         TRUE  4.05280959
## 23 1.3288133      1.172128 0.9733594 1.814073         TRUE  3.22360276
## 24 1.4870978      1.174499 1.0849964 2.038219         TRUE  6.15970848
## 25 1.0227476      1.199967 0.7154782 1.461977        FALSE  0.01522488
## 26 1.1990950      1.173416 0.8764509 1.640513        FALSE  1.29227094
## 27 0.8316017      1.196257 0.5853011 1.181548        FALSE  1.06170407
## 28 1.2407747      1.174064 0.9059350 1.699373        FALSE  1.81374693
## 29 1.5917785      1.148464 1.2135356 2.087915         TRUE 11.45533519
## 30 1.1624733      1.185918 0.8322158 1.623791        FALSE  0.78086795
## 31 0.9549285      1.191126 0.6777881 1.345389        FALSE  0.06954300
##         p_value
## 1  1.0000000000
## 2  0.1245321633
## 3  0.6269858537
## 4  0.5713893312
## 5  0.1837938138
## 6  0.6930932773
## 7  0.1490340319
## 8  0.0124384812
## 9  0.1102700972
## 10 0.5002310680
## 11 0.6517782580
## 12 0.2575765726
## 13 0.4497882886
## 14 0.3430736016
## 15 0.8561308473
## 16 0.2008712758
## 17 0.1945159073
## 18 0.0008344226
## 19 0.0544506771
## 20 0.0715819838
## 21 0.2826978722
## 22 0.0440978937
## 23 0.0725837146
## 24 0.0130692746
## 25 0.9017989513
## 26 0.2556298676
## 27 0.3028268487
## 28 0.1780594038
## 29 0.0007128903
## 30 0.3768758205
## 31 0.7920033368</code></pre>
<p>We can also create custom confidence intervals for rules based on different possibilities using the function customCI.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">customCI</span>(rules, trainingTrans, trainingNot, <span class="dt">alpha =</span> <span class="fl">1.598</span>)</code></pre>
<pre><code>##    lowCIcustom highCIcustom
## 1    0.9221508     1.084421
## 2    0.9875621     1.796376
## 3    0.8040861     1.504610
## 4    0.8188578     1.520288
## 5    0.9426986     1.880389
## 6    0.6646975     1.279762
## 7    0.5254247     1.034571
## 8    1.1721447     2.083712
## 9    0.9984558     1.915140
## 10   0.6421956     1.197454
## 11   0.8104007     1.455919
## 12   0.9147119     1.681635
## 13   0.8561216     1.543013
## 14   0.6011269     1.139104
## 15   0.7644012     1.401332
## 16   0.9327288     1.858895
## 17   0.9512685     1.611487
## 18   1.3567069     2.408690
## 19   1.0579023     1.867003
## 20   1.0375579     1.893910
## 21   0.9009684     1.698613
## 22   1.0826373     2.032155
## 23   1.0309607     1.712718
## 24   1.1500454     1.922933
## 25   0.7642857     1.368615
## 26   0.9286867     1.548239
## 27   0.6245279     1.107335
## 28   0.9601199     1.603468
## 29   1.2758953     1.985867
## 30   0.8852047     1.526589
## 31   0.7220887     1.262848</code></pre>
<p>We can also check for redundant rules using the function improvementcustomCI.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">improvement_customCI_par</span>(rules)</code></pre>
<pre><code>## Time difference of 5.163411 secs</code></pre>
<pre><code>##    impCIcustom_par
## 1             TRUE
## 2             TRUE
## 3             TRUE
## 4             TRUE
## 5             TRUE
## 6             TRUE
## 7             TRUE
## 8             TRUE
## 9             TRUE
## 10            TRUE
## 11            TRUE
## 12            TRUE
## 13            TRUE
## 14            TRUE
## 15            TRUE
## 16            TRUE
## 17            TRUE
## 18            TRUE
## 19            TRUE
## 20            TRUE
## 21            TRUE
## 22            TRUE
## 23            TRUE
## 24            TRUE
## 25            TRUE
## 26            TRUE
## 27            TRUE
## 28            TRUE
## 29            TRUE
## 30            TRUE
## 31            TRUE</code></pre>
<p>Which will return a logical vector with TRUE values for nonredundant rules and false values for redundant values.</p>
<p>These functions can be used on both the training set and also to validate them in the testing set, if a testing set and a negated testing set have been made.</p>
<pre class="sourceCode r"><code class="sourceCode r">sampleNot &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(!testing)
sampleNot$event &lt;-<span class="st"> </span>testing$event

testingTrans &lt;-<span class="st"> </span><span class="kw">as</span>(testing, <span class="st">&quot;transactions&quot;</span>)
testingNot &lt;-<span class="st"> </span><span class="kw">as</span>(sampleNot, <span class="st">&quot;transactions&quot;</span>)

<span class="kw">myOddsRatioExp</span>(rules, testingTrans, testingNot, <span class="dt">CI=</span><span class="ot">TRUE</span>, <span class="dt">t=</span><span class="fl">0.03</span>)</code></pre>
<pre><code>##    oddsRatio standardError   lowCI95  highCI95 significance  chi_squared
## 1  0.9131112      1.036572 0.8510379 0.9797120         TRUE 6.406424e+00
## 2  1.2024568      1.143653 0.9242988 1.5643234        FALSE 1.891581e+00
## 3  1.0006218      1.150977 0.7595902 1.3181370        FALSE 1.954063e-05
## 4  1.0179459      1.148942 0.7754260 1.3363155        FALSE 1.641215e-02
## 5  1.2016859      1.167609 0.8869279 1.6281470        FALSE 1.409517e+00
## 6  0.8491105      1.158382 0.6365241 1.1326966        FALSE 1.240286e+00
## 7  0.6801744      1.164230 0.5048753 0.9163397         TRUE 6.499579e+00
## 8  1.4183359      1.137761 1.1013337 1.8265825         TRUE 7.401841e+00
## 9  1.2471299      1.157372 0.9364934 1.6608051        FALSE 2.292068e+00
## 10 0.7990932      1.150045 0.6075704 1.0509891        FALSE 2.583792e+00
## 11 0.9787313      1.140447 0.7564778 1.2662830        FALSE 2.676041e-02
## 12 1.1163845      1.146380 0.8541413 1.4591430        FALSE 6.501114e-01
## 13 1.0403727      1.141298 0.8029462 1.3480048        FALSE 8.968884e-02
## 14 0.7597433      1.154249 0.5735348 1.0064078         TRUE 3.690771e+00
## 15 0.9451842      1.145676 0.7240278 1.2338935        FALSE 1.718865e-01
## 16 1.1949938      1.167393 0.8823085 1.6184932        FALSE 1.328090e+00
## 17 1.1282803      1.125509 0.8948976 1.4225274        FALSE 1.043191e+00
## 18 1.6293502      1.137429 1.2659094 2.0971343         TRUE 1.463787e+01
## 19 1.2655286      1.135887 0.9858603 1.6245330         TRUE 3.430568e+00
## 20 1.2612176      1.144537 0.9680009 1.6432526        FALSE 2.967664e+00
## 21 1.1149894      1.152887 0.8436621 1.4735775        FALSE 5.858623e-01
## 22 1.3363897      1.151740 1.0131609 1.7627382         TRUE 4.240719e+00
## 23 1.1899101      1.120544 0.9519921 1.4872877        FALSE 2.339279e+00
## 24 1.3545680      1.122218 1.0805609 1.6980574         TRUE 6.975417e+00
## 25 0.9358984      1.139652 0.7243617 1.2092107        FALSE 2.569189e-01
## 26 1.0912435      1.121454 0.8716664 1.3661331        FALSE 5.806203e-01
## 27 0.7734244      1.137133 0.6012120 0.9949656         TRUE 4.017470e+00
## 28 1.1253265      1.121886 0.8982128 1.4098661        FALSE 1.055071e+00
## 29 1.4276316      1.104190 1.1755743 1.7337330         TRUE 1.302233e+01
## 30 1.0662593      1.130055 0.8390494 1.3549963        FALSE 2.754250e-01
## 31 0.8847367      1.133633 0.6919076 1.1313057        FALSE 9.544221e-01
##         p_value
## 1  0.0113708190
## 2  0.1690237479
## 3  0.9964729800
## 4  0.8980619941
## 5  0.2351365190
## 6  0.2654160277
## 7  0.0107900019
## 8  0.0065157149
## 9  0.1300365875
## 10 0.1079627261
## 11 0.8700569898
## 12 0.4200728638
## 13 0.7645731031
## 14 0.0547143349
## 15 0.6784405905
## 16 0.2491453014
## 17 0.3070805338
## 18 0.0001302703
## 19 0.0640001040
## 20 0.0849444171
## 21 0.4440236066
## 22 0.0394654525
## 23 0.1261479163
## 24 0.0082636983
## 25 0.6122448305
## 26 0.4460692906
## 27 0.0450312070
## 28 0.3043420435
## 29 0.0003077990
## 30 0.5997156013
## 31 0.3285962341</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">customCI</span>(rules, testingTrans, testingNot, <span class="dt">alpha =</span> <span class="fl">1.598</span>)</code></pre>
<pre><code>##    lowCIcustom highCIcustom
## 1    0.8621759    0.9670556
## 2    0.9703200    1.4901293
## 3    0.7992552    1.2527212
## 4    0.8153955    1.2708113
## 5    0.9381017    1.5393310
## 6    0.6713193    1.0739876
## 7    0.5334457    0.8672622
## 8    1.1540096    1.7432063
## 9    0.9873746    1.5752209
## 10   0.6391096    0.9991242
## 11   0.7933364    1.2074511
## 12   0.8974426    1.3887399
## 13   0.8422964    1.2850290
## 14   0.6041047    0.9554799
## 15   0.7605637    1.1746197
## 16   0.9331533    1.5303062
## 17   0.9340317    1.3629263
## 18   1.3263167    2.0016199
## 19   1.0323968    1.5513053
## 20   1.0164820    1.5648775
## 21   0.8882503    1.3996071
## 22   1.0663229    1.6748562
## 23   0.9920341    1.4272554
## 24   1.1266194    1.6286373
## 25   0.7594636    1.1533218
## 26   0.9085967    1.3106061
## 27   0.6298416    0.9497392
## 28   0.9363984    1.3523729
## 29   1.2185181    1.6726317
## 30   0.8770202    1.2963314
## 31   0.7240476    1.0810878</code></pre>
<p>While the User can use each of these functions seperately. The user can also employ overfit_test to use all the functions without calling them individually and the output will be a list of four: the number of rules that a minimum threshold of support, significance, are nonredundant and a testframe displaying those rules.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">overfit_test</span>(whole_training, testing, <span class="dt">seed=</span><span class="dv">1</span>,<span class="dt">trainingsize=</span><span class="dv">5000</span>)</code></pre>
<pre><code>## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 5000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 done [0.00s].
## writing ... [268 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.07641 secs
## Time difference of 5.110818 secs</code></pre>
<pre><code>## $Support_Only
##       1
## 5000 31
## 
## $With_OR_Significance_Filter
##       1
## 5000 10
## 
## $With_Non_Redundancy_Filter
##       1
## 5000 10
## 
## $TestFrame
##                     rules     support confidence      lift oddsRatio
## 40   {val0_O3} =&gt; {event} 0.007213520  0.2017291 0.9739200 0.9661506
## 68   {val0_CO} =&gt; {event} 0.005152514  0.1838235 0.8874744 0.8586137
## 92   {val4_NO} =&gt; {event} 0.008553174  0.2569659 1.2405958 1.3377487
## 150  {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903 1.2570214
## 204  {val2_CO} =&gt; {event} 0.006286068  0.2132867 1.0297185 1.0389579
## 214  {val2_PM} =&gt; {event} 0.012778236  0.2588727 1.2498011 1.3592162
## 238 {val4_NO2} =&gt; {event} 0.010923331  0.2425629 1.1710600 1.2384136
## 240  {val4_PM} =&gt; {event} 0.012572135  0.2440000 1.1779980 1.2506614
## 256 {val3_NO2} =&gt; {event} 0.011438582  0.2444934 1.1803800 1.2527093
## 258 {val2_NO2} =&gt; {event} 0.011850783  0.2478448 1.1965603 1.2771885
##     standardError   lowCI95 highCI95 significance chi_squared     p_value
## 40       1.145893 0.7398140 1.261732        FALSE  0.06394430 0.800367047
## 68       1.171849 0.6292299 1.171619        FALSE  0.92568346 0.335987092
## 92       1.138688 1.0371015 1.725551         TRUE  5.05270649 0.024587504
## 150      1.136777 0.9777309 1.616092         TRUE  3.19667454 0.073788166
## 204      1.157864 0.7795230 1.384736        FALSE  0.06799187 0.794283379
## 214      1.113448 1.1010721 1.677882         TRUE  8.21395825 0.004156937
## 238      1.121341 0.9894173 1.550072         TRUE  3.49811460 0.061438737
## 240      1.113244 1.0134979 1.543322         TRUE  4.36333293 0.036720396
## 256      1.118728 1.0054266 1.560811         TRUE  4.04842159 0.044212666
## 258      1.116910 1.0283462 1.586246         TRUE  4.91849568 0.026570643
##     lowCIcustom highCIcustom impCIcustom_par
## 40    0.7771998     1.201039            TRUE
## 68    0.6664090     1.106254            TRUE
## 92    1.0870256     1.646301            TRUE
## 150   1.0241740     1.542807            TRUE
## 204   0.8220023     1.313176            TRUE
## 214   1.1447489     1.613864            TRUE
## 238   1.0312990     1.487123            TRUE
## 240   1.0536310     1.484537            TRUE
## 256   1.0471012     1.498691            TRUE
## 258   1.0703404     1.524011            TRUE</code></pre>
<p>In cases where the User may want to mine rules from the training set after being split in multiple different ways in different sizes, overfit-test can also be called to loop through different seeds and training sizes.</p>
<pre class="sourceCode r"><code class="sourceCode r">Results &lt;-<span class="st"> </span><span class="kw">overfit_test</span>(whole_training, testing, <span class="dt">seed=</span><span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">trainingsize=</span><span class="kw">c</span>(<span class="dv">5000</span>,<span class="dv">2000</span>,<span class="dv">1000</span>))</code></pre>
<pre><code>## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 5000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 done [0.00s].
## writing ... [268 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.07041 secs
## Time difference of 5.189814 secs
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 2000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 done [0.00s].
## writing ... [277 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.147216 secs
## Time difference of 5.06181 secs
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 1000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 4 5 done [0.00s].
## writing ... [435 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.89205 secs
## Time difference of 5.299131 secs
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 5000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 done [0.00s].
## writing ... [288 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.345849 secs
## Time difference of 5.344942 secs
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 2000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 done [0.00s].
## writing ... [263 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.493343 secs
## Time difference of 5.489251 secs
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 1000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.02s].
## checking subsets of size 1 2 3 done [0.00s].
## writing ... [272 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.32603 secs
## Time difference of 5.052633 secs
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 5000 transaction(s)] done [0.01s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 done [0.00s].
## writing ... [284 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.003411 secs
## Time difference of 5.663735 secs
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 2000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 4 done [0.00s].
## writing ... [385 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.588439 secs
## Time difference of 5.596586 secs
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport support minlen maxlen
##           0    0.1    1 none FALSE            TRUE   0.005      1      6
##  target   ext
##   rules FALSE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## apriori - find association rules with the apriori algorithm
## version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[31 item(s), 1000 transaction(s)] done [0.00s].
## sorting and recoding items ... [31 item(s)] done [0.00s].
## creating transaction tree ... done [0.00s].
## checking subsets of size 1 2 3 4 5 6 done [0.00s].
## writing ... [12588 rule(s)] done [0.00s].
## creating S4 object  ... done [0.00s].
## Time difference of 5.069712 secs
## Time difference of 5.068713 secs</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">Results</code></pre>
<pre><code>## $Support_Only
##       1  2  3
## 5000 31 31 31
## 2000 32 30 29
## 1000 38 29 31
## 
## $With_OR_Significance_Filter
##       1 2  3
## 5000 10 9 10
## 2000  8 7  3
## 1000  5 6  5
## 
## $With_Non_Redundancy_Filter
##       1 2  3
## 5000 10 8 10
## 2000  7 6  3
## 1000  4 4  3
## 
## $TestFrame
##                              rules     support confidence      lift
## 40            {val0_O3} =&gt; {event} 0.007213520  0.2017291 0.9739200
## 68            {val0_CO} =&gt; {event} 0.005152514  0.1838235 0.8874744
## 92            {val4_NO} =&gt; {event} 0.008553174  0.2569659 1.2405958
## 150           {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903
## 204           {val2_CO} =&gt; {event} 0.006286068  0.2132867 1.0297185
## 214           {val2_PM} =&gt; {event} 0.012778236  0.2588727 1.2498011
## 238          {val4_NO2} =&gt; {event} 0.010923331  0.2425629 1.1710600
## 240           {val4_PM} =&gt; {event} 0.012572135  0.2440000 1.1779980
## 256          {val3_NO2} =&gt; {event} 0.011438582  0.2444934 1.1803800
## 258          {val2_NO2} =&gt; {event} 0.011850783  0.2478448 1.1965603
## 42            {val0_O3} =&gt; {event} 0.007213520  0.2017291 0.9739200
## 58            {val0_CO} =&gt; {event} 0.005152514  0.1838235 0.8874744
## 88            {val0_NO} =&gt; {event} 0.005976917  0.1752266 0.8459695
## 100           {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903
## 2041          {val0_PM} =&gt; {event} 0.010923331  0.2339956 1.1296981
## 244           {val2_PM} =&gt; {event} 0.012778236  0.2588727 1.2498011
## 254           {val4_PM} =&gt; {event} 0.012572135  0.2440000 1.1779980
## 46            {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903
## 138           {val0_NO} =&gt; {event} 0.005976917  0.1752266 0.8459695
## 236           {val0_PM} =&gt; {event} 0.010923331  0.2339956 1.1296981
## 292           {val2_PM} =&gt; {event} 0.012778236  0.2588727 1.2498011
## 66            {val0_CO} =&gt; {event} 0.005152514  0.1838235 0.8874744
## 142           {val0_NO} =&gt; {event} 0.005976917  0.1752266 0.8459695
## 176           {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903
## 184           {val0_PM} =&gt; {event} 0.010923331  0.2339956 1.1296981
## 218           {val1_CO} =&gt; {event} 0.005049464  0.2000000 0.9655721
## 228          {val4_NO2} =&gt; {event} 0.010923331  0.2425629 1.1710600
## 2561         {val0_NO2} =&gt; {event} 0.010098928  0.2207207 1.0656089
## 2581          {val4_PM} =&gt; {event} 0.012572135  0.2440000 1.1779980
## 32            {val4_O3} =&gt; {event} 0.008244023  0.2051282 0.9903304
## 581           {val0_CO} =&gt; {event} 0.005152514  0.1838235 0.8874744
## 106           {val0_NO} =&gt; {event} 0.005976917  0.1752266 0.8459695
## 162           {val1_CO} =&gt; {event} 0.005049464  0.2000000 0.9655721
## 178           {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903
## 212           {val0_PM} =&gt; {event} 0.010923331  0.2339956 1.1296981
## 582           {val0_CO} =&gt; {event} 0.005152514  0.1838235 0.8874744
## 134           {val0_NO} =&gt; {event} 0.005976917  0.1752266 0.8459695
## 182           {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903
## 230          {val0_NO2} =&gt; {event} 0.010098928  0.2207207 1.0656089
## 48            {val4_O3} =&gt; {event} 0.008244023  0.2051282 0.9903304
## 881           {val4_NO} =&gt; {event} 0.008553174  0.2569659 1.2405958
## 126           {val3_NO} =&gt; {event} 0.007110470  0.2041420 0.9855692
## 158           {val2_CO} =&gt; {event} 0.006286068  0.2132867 1.0297185
## 180           {val1_NO} =&gt; {event} 0.006079967  0.1915584 0.9248175
## 202           {val3_PM} =&gt; {event} 0.009377576  0.1903766 0.9191116
## 220           {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903
## 246           {val2_PM} =&gt; {event} 0.012778236  0.2588727 1.2498011
## 2541          {val1_PM} =&gt; {event} 0.011026381  0.2257384 1.0898335
## 2562          {val4_PM} =&gt; {event} 0.012572135  0.2440000 1.1779980
## 216           {val1_PM} =&gt; {event} 0.011026381  0.2257384 1.0898335
## 276           {val2_PM} =&gt; {event} 0.012778236  0.2588727 1.2498011
## 346  {val3_NO,val3_NO2} =&gt; {event} 0.002679308  0.2113821 1.0205234
## 2542          {val3_PM} =&gt; {event} 0.009377576  0.1903766 0.9191116
## 298           {val3_NO} =&gt; {event} 0.007110470  0.2041420 0.9855692
## 813   {val2_NO,val2_PM} =&gt; {event} 0.002164056  0.2763158 1.3340141
##      oddsRatio standardError   lowCI95 highCI95 significance chi_squared
## 40   0.9661506      1.145893 0.7398140 1.261732        FALSE 0.063944301
## 68   0.8586137      1.171849 0.6292299 1.171619        FALSE 0.925683464
## 92   1.3377487      1.138688 1.0371015 1.725551         TRUE 5.052706487
## 150  1.2570214      1.136777 0.9777309 1.616092         TRUE 3.196674539
## 204  1.0389579      1.157864 0.7795230 1.384736        FALSE 0.067991865
## 214  1.3592162      1.113448 1.1010721 1.677882         TRUE 8.213958247
## 238  1.2384136      1.121341 0.9894173 1.550072         TRUE 3.498114602
## 240  1.2506614      1.113244 1.0134979 1.543322         TRUE 4.363332927
## 256  1.2527093      1.118728 1.0054266 1.560811         TRUE 4.048421590
## 258  1.2771885      1.116910 1.0283462 1.586246         TRUE 4.918495675
## 42   0.9661506      1.145893 0.7398140 1.261732        FALSE 0.063944301
## 58   0.8586137      1.171849 0.6292299 1.171619        FALSE 0.925683464
## 88   0.8076961      1.158127 0.6057394 1.076986        FALSE 2.124013240
## 100  1.2570214      1.136777 0.9777309 1.616092         TRUE 3.196674539
## 2041 1.1787440      1.120659 0.9428687 1.473628        FALSE 2.088196346
## 244  1.3592162      1.113448 1.1010721 1.677882         TRUE 8.213958247
## 254  1.2506614      1.113244 1.0134979 1.543322         TRUE 4.363332927
## 46   1.2570214      1.136777 0.9777309 1.616092         TRUE 3.196674539
## 138  0.8076961      1.158127 0.6057394 1.076986        FALSE 2.124013240
## 236  1.1787440      1.120659 0.9428687 1.473628        FALSE 2.088196346
## 292  1.3592162      1.113448 1.1010721 1.677882         TRUE 8.213958247
## 66   0.8586137      1.171849 0.6292299 1.171619        FALSE 0.925683464
## 142  0.8076961      1.158127 0.6057394 1.076986        FALSE 2.124013240
## 176  1.2570214      1.136777 0.9777309 1.616092         TRUE 3.196674539
## 184  1.1787440      1.120659 0.9428687 1.473628        FALSE 2.088196346
## 218  0.9558899      1.175532 0.6962234 1.312403        FALSE 0.077827951
## 228  1.2384136      1.121341 0.9894173 1.550072         TRUE 3.498114602
## 2561 1.0885070      1.124428 0.8649778 1.369801        FALSE 0.523229305
## 2581 1.2506614      1.113244 1.0134979 1.543322         TRUE 4.363332927
## 32   0.9873308      1.136532 0.7682849 1.268829        FALSE 0.009925219
## 581  0.8586137      1.171849 0.6292299 1.171619        FALSE 0.925683464
## 106  0.8076961      1.158127 0.6057394 1.076986        FALSE 2.124013240
## 162  0.9558899      1.175532 0.6962234 1.312403        FALSE 0.077827951
## 178  1.2570214      1.136777 0.9777309 1.616092         TRUE 3.196674539
## 212  1.1787440      1.120659 0.9428687 1.473628        FALSE 2.088196346
## 582  0.8586137      1.171849 0.6292299 1.171619        FALSE 0.925683464
## 134  0.8076961      1.158127 0.6057394 1.076986        FALSE 2.124013240
## 182  1.2570214      1.136777 0.9777309 1.616092         TRUE 3.196674539
## 230  1.0885070      1.124428 0.8649778 1.369801        FALSE 0.523229305
## 48   0.9873308      1.136532 0.7682849 1.268829        FALSE 0.009925219
## 881  1.3377487      1.138688 1.0371015 1.725551         TRUE 5.052706487
## 126  0.9812230      1.147209 0.7496668 1.284302        FALSE 0.019051900
## 158  1.0389579      1.157864 0.7795230 1.384736        FALSE 0.067991865
## 180  0.9041908      1.158366 0.6778322 1.206141        FALSE 0.469716949
## 202  0.8953536      1.126701 0.7086795 1.131200        FALSE 0.859373744
## 220  1.2570214      1.136777 0.9777309 1.616092         TRUE 3.196674539
## 246  1.3592162      1.113448 1.1010721 1.677882         TRUE 8.213958247
## 2541 1.1225485      1.119451 0.8998185 1.400410        FALSE 1.050626285
## 2562 1.2506614      1.113244 1.0134979 1.543322         TRUE 4.363332927
## 216  1.1225485      1.119451 0.8998185 1.400410        FALSE 1.050626285
## 276  1.3592162      1.113448 1.1010721 1.677882         TRUE 8.213958247
## 346  1.0367823      1.249035 0.6705042 1.603148        FALSE 0.026389637
## 2542 0.8953536      1.126701 0.7086795 1.131200        FALSE 0.859373744
## 298  0.9812230      1.147209 0.7496668 1.284302        FALSE 0.019051900
## 813  1.4945993      1.294152 0.9016409 2.477513        FALSE 2.460993997
##          p_value lowCIcustom highCIcustom impCIcustom_par
## 40   0.800367047   0.7771998     1.201039            TRUE
## 68   0.335987092   0.6664090     1.106254            TRUE
## 92   0.024587504   1.0870256     1.646301            TRUE
## 150  0.073788166   1.0241740     1.542807            TRUE
## 204  0.794283379   0.8220023     1.313176            TRUE
## 214  0.004156937   1.1447489     1.613864            TRUE
## 238  0.061438737   1.0312990     1.487123            TRUE
## 240  0.036720396   1.0536310     1.484537            TRUE
## 256  0.044212666   1.0471012     1.498691            TRUE
## 258  0.026570643   1.0703404     1.524011            TRUE
## 42   0.800367047   0.7771998     1.201039            TRUE
## 58   0.335987092   0.6664090     1.106254            TRUE
## 88   0.145006141   0.6388010     1.021246            TRUE
## 100  0.073788166   1.0241740     1.542807            TRUE
## 2041 0.148441233   0.9825636     1.414094            TRUE
## 244  0.004156937   1.1447489     1.613864            TRUE
## 254  0.036720396   1.0536310     1.484537            TRUE
## 46   0.073788166   1.0241740     1.542807            TRUE
## 138  0.145006141   0.6388010     1.021246            TRUE
## 236  0.148441233   0.9825636     1.414094            TRUE
## 292  0.004156937   1.1447489     1.613864            TRUE
## 66   0.335987092   0.6664090     1.106254            TRUE
## 142  0.145006141   0.6388010     1.021246            TRUE
## 176  0.073788166   1.0241740     1.542807            TRUE
## 184  0.148441233   0.9825636     1.414094            TRUE
## 218  0.780262772   0.7381989     1.237777            TRUE
## 228  0.061438737   1.0312990     1.487123            TRUE
## 2561 0.469467394   0.9024898     1.312865            TRUE
## 2581 0.036720396   1.0536310     1.484537            TRUE
## 32   0.920641731   0.8047165     1.211386            TRUE
## 581  0.335987092   0.6664090     1.106254            TRUE
## 106  0.145006141   0.6388010     1.021246            TRUE
## 162  0.780262772   0.7381989     1.237777            TRUE
## 178  0.073788166   1.0241740     1.542807            TRUE
## 212  0.148441233   0.9825636     1.414094            TRUE
## 582  0.335987092   0.6664090     1.106254            TRUE
## 134  0.145006141   0.6388010     1.021246            TRUE
## 182  0.073788166   1.0241740     1.542807            TRUE
## 230  0.469467394   0.9024898     1.312865            TRUE
## 48   0.920641731   0.8047165     1.211386            TRUE
## 881  0.024587504   1.0870256     1.646301            TRUE
## 126  0.890217798   0.7878779     1.222015            TRUE
## 158  0.794283379   0.8220023     1.313176            TRUE
## 180  0.493117414   0.7148821     1.143631            TRUE
## 202  0.353914004   0.7399537     1.083389            TRUE
## 220  0.073788166   1.0241740     1.542807            TRUE
## 246  0.004156937   1.1447489     1.613864            TRUE
## 2541 0.305362892   0.9373350     1.344360            TRUE
## 2562 0.036720396   1.0536310     1.484537            TRUE
## 216  0.305362892   0.9373350     1.344360            TRUE
## 276  0.004156937   1.1447489     1.613864            TRUE
## 346  0.870952386   0.7267106     1.479155            TRUE
## 2542 0.353914004   0.7399537     1.083389            TRUE
## 298  0.890217798   0.7878779     1.222015            TRUE
## 813  0.116704908   0.9898566     2.256718            TRUE</code></pre>
<p>In which case the output will include 3 matrices with the number of rules meeting a minumum threshold of support, significance and are nonredundant at each iteration, and a dataframe TestFrame with said successful rules and summary statistics from all above mentioned functions. The function overfit_test works on multiple for loops, so it may run slow depending on the amount of data and rules generated. The user has been warned.</p>
<p>Because the rules mined in the above line have been mined from several different samples of the training set a lot of them are repetitive or redundant. We can filter them out using the nonredundant function. This function requires a dataframe of the rules including confidence intervals for the rules and a vector of strings with the names of the variables used to make the rules.</p>
<pre class="sourceCode r"><code class="sourceCode r">variables &lt;-<span class="st"> </span><span class="kw">colnames</span>(binned)[-<span class="dv">1</span>] 
<span class="kw">nonredundant</span>(Results$TestFrame,variables)</code></pre>
<pre><code>##                              rules     support confidence      lift
## 40            {val0_O3} =&gt; {event} 0.007213520  0.2017291 0.9739200
## 68            {val0_CO} =&gt; {event} 0.005152514  0.1838235 0.8874744
## 92            {val4_NO} =&gt; {event} 0.008553174  0.2569659 1.2405958
## 150           {val2_NO} =&gt; {event} 0.008656224  0.2456140 1.1857903
## 204           {val2_CO} =&gt; {event} 0.006286068  0.2132867 1.0297185
## 214           {val2_PM} =&gt; {event} 0.012778236  0.2588727 1.2498011
## 238          {val4_NO2} =&gt; {event} 0.010923331  0.2425629 1.1710600
## 240           {val4_PM} =&gt; {event} 0.012572135  0.2440000 1.1779980
## 256          {val3_NO2} =&gt; {event} 0.011438582  0.2444934 1.1803800
## 258          {val2_NO2} =&gt; {event} 0.011850783  0.2478448 1.1965603
## 88            {val0_NO} =&gt; {event} 0.005976917  0.1752266 0.8459695
## 2041          {val0_PM} =&gt; {event} 0.010923331  0.2339956 1.1296981
## 218           {val1_CO} =&gt; {event} 0.005049464  0.2000000 0.9655721
## 2561         {val0_NO2} =&gt; {event} 0.010098928  0.2207207 1.0656089
## 32            {val4_O3} =&gt; {event} 0.008244023  0.2051282 0.9903304
## 126           {val3_NO} =&gt; {event} 0.007110470  0.2041420 0.9855692
## 180           {val1_NO} =&gt; {event} 0.006079967  0.1915584 0.9248175
## 202           {val3_PM} =&gt; {event} 0.009377576  0.1903766 0.9191116
## 2541          {val1_PM} =&gt; {event} 0.011026381  0.2257384 1.0898335
## 346  {val3_NO,val3_NO2} =&gt; {event} 0.002679308  0.2113821 1.0205234
## 813   {val2_NO,val2_PM} =&gt; {event} 0.002164056  0.2763158 1.3340141
##      oddsRatio standardError   lowCI95 highCI95 significance chi_squared
## 40   0.9661506      1.145893 0.7398140 1.261732        FALSE 0.063944301
## 68   0.8586137      1.171849 0.6292299 1.171619        FALSE 0.925683464
## 92   1.3377487      1.138688 1.0371015 1.725551         TRUE 5.052706487
## 150  1.2570214      1.136777 0.9777309 1.616092         TRUE 3.196674539
## 204  1.0389579      1.157864 0.7795230 1.384736        FALSE 0.067991865
## 214  1.3592162      1.113448 1.1010721 1.677882         TRUE 8.213958247
## 238  1.2384136      1.121341 0.9894173 1.550072         TRUE 3.498114602
## 240  1.2506614      1.113244 1.0134979 1.543322         TRUE 4.363332927
## 256  1.2527093      1.118728 1.0054266 1.560811         TRUE 4.048421590
## 258  1.2771885      1.116910 1.0283462 1.586246         TRUE 4.918495675
## 88   0.8076961      1.158127 0.6057394 1.076986        FALSE 2.124013240
## 2041 1.1787440      1.120659 0.9428687 1.473628        FALSE 2.088196346
## 218  0.9558899      1.175532 0.6962234 1.312403        FALSE 0.077827951
## 2561 1.0885070      1.124428 0.8649778 1.369801        FALSE 0.523229305
## 32   0.9873308      1.136532 0.7682849 1.268829        FALSE 0.009925219
## 126  0.9812230      1.147209 0.7496668 1.284302        FALSE 0.019051900
## 180  0.9041908      1.158366 0.6778322 1.206141        FALSE 0.469716949
## 202  0.8953536      1.126701 0.7086795 1.131200        FALSE 0.859373744
## 2541 1.1225485      1.119451 0.8998185 1.400410        FALSE 1.050626285
## 346  1.0367823      1.249035 0.6705042 1.603148        FALSE 0.026389637
## 813  1.4945993      1.294152 0.9016409 2.477513        FALSE 2.460993997
##          p_value lowCIcustom highCIcustom impCIcustom_par nonredundant
## 40   0.800367047   0.7771998     1.201039            TRUE         TRUE
## 68   0.335987092   0.6664090     1.106254            TRUE         TRUE
## 92   0.024587504   1.0870256     1.646301            TRUE         TRUE
## 150  0.073788166   1.0241740     1.542807            TRUE         TRUE
## 204  0.794283379   0.8220023     1.313176            TRUE         TRUE
## 214  0.004156937   1.1447489     1.613864            TRUE         TRUE
## 238  0.061438737   1.0312990     1.487123            TRUE         TRUE
## 240  0.036720396   1.0536310     1.484537            TRUE         TRUE
## 256  0.044212666   1.0471012     1.498691            TRUE         TRUE
## 258  0.026570643   1.0703404     1.524011            TRUE         TRUE
## 88   0.145006141   0.6388010     1.021246            TRUE         TRUE
## 2041 0.148441233   0.9825636     1.414094            TRUE         TRUE
## 218  0.780262772   0.7381989     1.237777            TRUE         TRUE
## 2561 0.469467394   0.9024898     1.312865            TRUE         TRUE
## 32   0.920641731   0.8047165     1.211386            TRUE         TRUE
## 126  0.890217798   0.7878779     1.222015            TRUE         TRUE
## 180  0.493117414   0.7148821     1.143631            TRUE         TRUE
## 202  0.353914004   0.7399537     1.083389            TRUE         TRUE
## 2541 0.305362892   0.9373350     1.344360            TRUE         TRUE
## 346  0.870952386   0.7267106     1.479155            TRUE        FALSE
## 813  0.116704908   0.9898566     2.256718            TRUE        FALSE</code></pre>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
